function extendPvalJquery(){jQuery.fn.extend({pVal:function(){var n=jQuery(this).eq(0).val(),t=jQuery(this).attr("placeholder");return n==t?"":n}})}function FuturePayResponseHandler(n){n.error?(error_code=n.code,error_reason=n.message,alert(n.message)):(transaction_id=n.transaction_id,fp_params="fptransaction_id|||"+transaction_id,doCheckout(document.billing,fp_params))}function get_Element(n){return document.getElementById(n)||document.getElementsByName(n).item(0)}function addressValidatorContinue(n){var t;jQuery("#divAddrressValidator").modal("hide"),remove_overlay("billing_info"),t=get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?get_Element("sameAsBilling").checked:!0,t||remove_overlay("shipping_info"),validShippingAddress=1,check_address(n),check_address("refresh")}function check_address2_pos(n){jQuery("#hdnAddrressValidatorResult").val()=="1"?(jQuery("#divAddrressValidator").modal("hide"),validShippingAddress=1,check_address(n)):(validShippingAddress=0,jQuery("#divAddrressValidator").modal("show"))}function closeAddressValidatorModal(){var n;jQuery("#divAddrressValidator").modal("hide"),n=get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?get_Element("sameAsBilling").checked:!0,n||remove_overlay("shipping_info")}function select_shipping(n){var i,t;selectedShipId=n,(selectedShipId=="undefined"||selectedShipId==null)&&(selectedShipId=jQuery("input[name=shipping]:checked").val()),add_overlay("total_div",1),n!="-1"&&add_overlay("divPayment",1),i="ship_ajax.asp?action1=total&no-cache="+Math.random()+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():""),jQuery("#wid").val()==3&&(i+="&access_token="+jQuery("#access_token").val()+"&orderReference="+orderReferenceID),t="id="+selectedShipId+"&action=total",jQuery("input[name=insurance]:checked","#billing").val()!="undefined"&&jQuery("input[name=insurance]:checked","#billing").val()!="null"&&(t=t+"&insurance="+jQuery("input[name=insurance]:checked","#billing").val()),jQuery.ajax({url:i,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){jQuery("#total_div").html(n),flagPageLoaded()},complete:updateajax_total,error:reportError})}function applyCoupon(n){var t="",r,i;if(jQuery.trim(n)==""&&(t+=" - Coupon cannot be blank.\n"),t!="")return alert(t),!1;add_overlay("total_div",1),r="ship_ajax.asp?action1=total&no-cache="+Math.random(),i="id="+selectedShipId+"&action=total&coupon="+encodeURIComponent(n)+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():""),jQuery("#wid").val()==3&&(i+="&access_token="+jQuery("#access_token").val()+"&orderReference="+orderReferenceID),jQuery.ajax({url:r,dataType:"html",type:"POST",data:i,cache:!1,success:function(n){jQuery("#total_div").html(n)},complete:updateajax_total,error:reportError})}function doPayment(){var t="action=dopayment&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():"")+"&billing_state="+jQuery("#billing_state").val()+"&billing_country="+jQuery("#billing_country").val()+"&access_token="+jQuery("#access_token").val(),n;add_overlay("divPayment",1),n="checkout_one.asp",jQuery.ajax({url:n,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){var t;if(n=="redirect_login"){location.href="myaccount.asp?returnUrl=checkout_one%2Easp";return}var i=jQuery("input:radio",jQuery.parseHTML(strOriginalDivPaymentContent)),u=jQuery("input:radio",jQuery.parseHTML(n)),r=!0,e=jQuery("#hdnPayPalAdvID").length>0&&jQuery("#hdnPayPalAdvID").val()==jQuery("input[name=payment]:checked","#"+document.billing.name).val(),f=!1;if(jQuery("#hdnPayFortID").length>0&&(f=!0),i.length==u.length&&e==!1&&f==!1){for(t=0;t<i.length;t++)if(i[t].value.toLowerCase()!=u[t].value.toLowerCase()){r=!1;break}}else r=!1;r||(n.indexOf("PayWithAmazon")>0&&(n=n.replace(/<script type='text\/javascript' src='https:\/\/static-na\.payments-amazon\.com\/OffAmazonPayments\/us\/(|sandbox\/)js\/Widgets\.js'><\/script>/gi,"")),jQuery("#divPayment").html(n),strOriginalDivPaymentContent=n,strOriginalDivPaymentContent.indexOf("onVmeReady")>0&&(strOriginalDivPaymentContent=""))},complete:paymentSuccess,error:reportError}),remove_overlay("divPayment")}function paymentSuccess(){controlDivPayment(""),remove_overlay("divPayment")}function checkoutQuestionsSuccess(){remove_overlay("divCheckoutQuestions")}function doCart(){var t="action=docart&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():"")+"&access_token="+jQuery("#access_token").val(),n;add_overlay("divCart",1),n="checkout_one.asp",jQuery.ajax({url:n,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){if(n=="redirect_login"){location.href="myaccount.asp?returnUrl=checkout_one%2Easp";return}jQuery("#divCart").html(n)},complete:cartSuccess,error:reportError})}function cartSuccess(){remove_overlay("divCart")}function selectAddress(n,t,i,r,u,f,e){var o;jQuery("#divAddrressValidator").modal("hide"),getElementById_s(f+"_address").value=n,getElementById_s(f+"_address2").value=t,getElementById_s(f+"_city").value=i,getElementById_s(f+"_zip").value=u,getElementById_s(f+"_state").value=r,remove_overlay("billing_info"),o=get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?get_Element("sameAsBilling").checked:!0,o||remove_overlay("shipping_info"),getElementById_s("shipping_addresstype")&&e!=""&&(getElementById_s("shipping_addresstype").value=e=="R"?"1":"2"),check_address(f)}function doCheckout(n,t){var e,o,k;if(setValidation(),e=!1,jQuery("#hdnPayPalBraintreeID").length>0&&jQuery("#hdnPayPalBraintreeID").val()==jQuery("input[name=payment]:checked","#"+n.name).val()&&t=="checkoutButton"){o=document.createEvent("Event"),o.initEvent("submit",!0,!0),n.dispatchEvent(o);return}extraParamsQueryString="";try{if(jQuery("#hdnFuturePayID").length>0&&jQuery("#hdnFuturePayID").val()==jQuery("input[name=payment]:checked","#"+n.name).val()){if(t=="checkoutButton"){FP.CartIntegration(),FP.CartIntegration.placeOrder();return}t!=null&&t!="undefined"&&(arrParams=t.split("|||"),arrParams[0]=="fptransaction_id"&&(extraParamsQueryString="&futurepay_callback=1&futurepay_transactionid="+arrParams[1]))}}catch(g){}try{if(jQuery("#hdnWePayID").length>0&&jQuery("#hdnWePayID").val()==jQuery("input[name=payment]:checked","#"+n.name).val()&&t=="checkoutButton"){WePay.set_endpoint(wepayEnvironment),k=WePay.credit_card.create({client_id:jQuery("#hdnWePayClientID").val(),user_name:jQuery("#billing_firstname").val()+" "+jQuery("#billing_lastname").val(),email:jQuery("#billing_email").val(),cc_number:jQuery("#wepay_ocardno").val(),cvv:jQuery("#wepay_ocardcvv2").val(),expiration_month:jQuery("#wepay_ocardexpiresmonth").val(),expiration_year:jQuery("#wepay_ocardexpiresyear").val(),address:{zip:jQuery("#billing_zip").val()}},function(t){if(t.error)return alert(jQuery("#hdnWePayGenericErrorMsg").val()+"\nWePay details: "+t.error_description),!1;CardLastFour=jQuery("#wepay_ocardno").val(),CardLastFour=CardLastFour.trim(),CardLastFour=CardLastFour.substr(CardLastFour.length-4),hdnWePayRef=t.credit_card_id+"||||"+CardLastFour+"||||"+jQuery("#wepay_ocardexpiresmonth").val()+"||||"+jQuery("#wepay_ocardexpiresyear").val(),jQuery("#hdnWePayRef").val(hdnWePayRef),jQuery(".wepaydiv :input").attr("disabled",!0),doCheckoutNormal(n);return});return}}catch(g){}if(jQuery("#hdnPayFortID").length>0&&jQuery("#hdnPayFortID").val()==jQuery("input[name=payment]:checked","#"+n.name).val()&&t=="checkoutButton"){doPayFortClientToken();return}if(jQuery("#hdnWorldPayID").length>0&&jQuery("#hdnWorldPayID").val()==jQuery("input[name=payment]:checked","#"+n.name).val()&&t=="checkoutButton"){e=!0;var i=jQuery("#hdnWorldPayError201").val(),f=!1,d=jQuery("#hdnWorldPayID").val().split("-"),r=d[1],c=jQuery("#hdnWorldPayPublicKey").val(),u;jQuery("input[name=ff"+r+"_savecc]").is(":checked")&&(f=!0);var s=jQuery("input[name=ff"+r+"_ocardno]").val(),l=jQuery("input[name=ff"+r+"_ocardcvv2]").val(),a=jQuery("select[name=ff"+r+"_ocardexpiresmonth] option:selected").val(),v=jQuery("select[name=ff"+r+"_ocardexpiresyear] option:selected").val(),y=a+"/"+v,p=jQuery("#billing_firstname").val(),w=jQuery("#billing_lastname").val(),b=jQuery("#billing_zip").val(),h="-1",nt;f?jQuery.ajax({url:"checkout_one.asp",dataType:"html",type:"POST",cache:!1,data:{action:"getworldpaycustomerid",cardlastdigits:right(s,4),cardexpirationyear:v,cardexpirationmonth:a}}).success(function(t){if(h=t.toString(),u=createWorldPayJSONObject(f,h,c,s,l,y,p,w,b),typeof u!="undefined")var r=tokenizeCard(u).done(function(t){var r=jQuery.parseJSON(JSON.stringify(t));if(r.success){jQuery("#hdnWorldPayToken").val(r.token),jQuery("#hdnWorldPayCustomerID").val(r.customerId),doCheckoutNormal(n);return}alert(i);return}).fail(function(){alert(i);return});else{doCheckoutNormal(n);return}}).error(function(){alert(i);return}):(u=createWorldPayJSONObject(f,h,c,s,l,y,p,w,b),k=tokenizeCard(u).done(function(t){var r=jQuery.parseJSON(JSON.stringify(t));if(r.success){jQuery("#hdnWorldPayToken").val(r.token),doCheckoutNormal(n);return}alert(i);return}).fail(function(){alert(i);return}))}e||doCheckoutNormal(n)}function right(n,t){return n.slice(n.length-t,n.length)}function createWorldPayJSONObject(n,t,i,r,u,f,e,o,s){var h;return n?(arrCustomerInfo=t.split(";"),(t=="0;0"||arrCustomerInfo[1]=="0")&&(h={publicKey:i,card:{number:r,cvv:u,expirationDate:f,firstName:e,lastName:o,address:{line1:jQuery("#billing_address").val(),city:jQuery("#billing_city").val(),state:jQuery("#billing_state").val(),zip:s,country:jQuery("#billing_country").val()}},addToVault:!0,developerApplication:{developerId:10000002,version:"1.2"}})):h={publicKey:i,card:{number:r,cvv:u,expirationDate:f,firstName:e,lastName:o,address:{line1:jQuery("#billing_address").val(),city:jQuery("#billing_city").val(),state:jQuery("#billing_state").val(),zip:s,country:jQuery("#billing_country").val()}},developerApplication:{developerId:10000002,version:"1.2"}},h}function doCheckoutNormal(n){var t,u,f,r,i,e;if(!n.onsubmit()||!checkotherreqfields())return checkoutSwitch(!1),!1;if(validShippingAddress==0){isSubmitComplete=!1,check_address("refresh"),checkoutSwitch(!1);return}t="action=docheckout"+extraParamsQueryString,u=getValuesAsArray(n),jQuery(".wepaydiv :input").attr("disabled",!1);for(r in u)r.indexOf("Paymetric")<0&&(i=u[r],i=encodeURIComponent(i),t=t+"&"+r+"="+i);if(document.eci_form!=null&&document.eci_form!="undefined"){t=t+"&elayawayParams=",f=getValuesAsArray(document.eci_form);for(r in f)i=f[r],i=encodeURIComponent(i),t=t+r+"="+i+"|"}get_Element("divCheckout").style.display="block",add_overlay("billing_div",1),e="checkout_one.asp?access_token="+jQuery("#access_token").val()+"&orderreference="+jQuery("#orderreference").val(),jQuery.ajax({url:e,dataType:"html",type:"POST",data:t,cache:!1,success:function(t){if(t=="redirect_login"){location.href="myaccount.asp?returnUrl=checkout_one%2Easp";return}if(t=="run_paymetric")return isSubmitComplete=!1,xis2(n);jQuery("#divCheckout").html(t)},complete:checkoutSuccess,error:reportError})}function checkoutSuccess(n){if(remove_overlay("billing_div"),n.responseText!="run_paymetric"){var t=getInnerText("divCheckout");if(t.indexOf("ORDER PLACED")>=0||t.indexOf("REDIRECTING")>=0)return void 0;if(isSubmitComplete=!1,t.indexOf("INVALID_CART")>=0)return doCart(),check_address("InvalidCart"),alert(t.replace("INVALID_CART","")),void 0;if(t.indexOf("REDIRECT")>=0||t.indexOf("FUTUREPAY-FORM")>=0||jQuery("#hdnAffirmID").length>0&&jQuery("#hdnAffirmID").val()==jQuery("input[name=payment]:checked","#"+document.billing.name).val())return void 0;alert(t.replace("<li>","\n - "))}}function checkoutFailure(){remove_overlay("billing_div")}function removeCoupon(n){var r=confirm("Are you sure you want to remove this coupon?"),i,t;if(!r)return void 0;add_overlay("total_div",1),i="ship_ajax.asp?action1=total&no-cache="+Math.random(),t="id="+selectedShipId+"&action=total&removeCoupon=1&coupon="+encodeURIComponent(n)+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():""),jQuery("#wid").val()==3&&(t+="&access_token="+jQuery("#access_token").val()+"&orderReference="+orderReferenceID),jQuery.ajax({url:i,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){jQuery("#total_div").html(n)},complete:updateajax_total,error:reportError})}function updateajax_total(){var t=getInnerText("total_div");t.indexOf("divCouponApplied")>=0?(check_address("CouponApplied"),doCart()):(bolPageLoaded&&doPayment(),window.setTimeout("flagPageLoaded()",1e3)),remove_overlay("divPayment"),remove_overlay("total_div")}function flagPageLoaded(){bolPageLoaded=!0}function getInnerText(n){return document.all?get_Element(n).innerText:get_Element(n).textContent}function initpage(){check_address("shipping"),document.billing.shipping_zip?(document.billing.shipping_zip.value==""||document.billing.shipping_zip.value=="Zip")&&select_shipping(-1):select_shipping(-1),controlDivPayment(""),strOriginalDivPaymentContent=jQuery("#divPayment").html(),strOriginalDivPaymentContent.indexOf("onVmeReady")>0&&(strOriginalDivPaymentContent="");var n=jQuery("input:radio",jQuery.parseHTML(strOriginalDivPaymentContent));n.length<=0&&doPayment(),jQuery("#sameAsBilling").length>0&&jQuery("#sameAsBilling").is(":checked")&&(showHideShipping(),check_address(""))}function check_address(n){var t;isSubmitComplete=!1,get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?t=get_Element("sameAsBilling").checked:(t=!0,n=="shipping"&&(n="billing")),n==""&&(n=t?"billing":"shipping"),n=="billing"&&t||!t&&n=="shipping"||n=="CouponApplied"||n=="addresstype"||n=="InvalidCart"||n=="refresh"?check_address2(n):n=="billing"&&jQuery("#billing_country").val()!=""&&jQuery("#billing_state").val()!=""&&(jQuery("#billing_zip").val()!=""||jQuery("#billing_country").val()!="US"&&jQuery("#billing_country").val()!="CA")&&doPayment()}function check_address2(n){var l=!1,i=n,u,o,a,s,h,f,t,c,r,e;if(u=get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?get_Element("sameAsBilling").checked:!0,(i=="CouponApplied"||i=="InvalidCart"||i=="refresh"||i=="addresstype")&&(n=u?"billing":"shipping"),addrchange=0,jQuery("#"+n+"_address").pVal()!=saddress&&(saddress=encodeURIComponent(removeHTMLTags(jQuery("#"+n+"_address").pVal())),addrchange=1),jQuery("#"+n+"_state").pVal()!=sstate&&jQuery.trim(jQuery("#"+n+"_state").pVal()).length>0&&(sstate=encodeURIComponent(removeHTMLTags(jQuery("#"+n+"_state").pVal())),addrchange=1),jQuery("#"+n+"_city").pVal()!=scity&&(scity=encodeURIComponent(removeHTMLTags(jQuery("#"+n+"_city").pVal())),addrchange=1),jQuery("#"+n+"_country").pVal()!=scountry&&jQuery.trim(jQuery("#"+n+"_country").pVal()).length>0&&(scountry=encodeURIComponent(removeHTMLTags(jQuery("#"+n+"_country").pVal())),addrchange=1),(jQuery("#"+n+"_zip").pVal()!=szip||jQuery("#"+n+"_country").pVal()!="US")&&(szip=encodeURIComponent(removeHTMLTags(jQuery("#"+n+"_zip").pVal())),addrchange=1),(i=="CouponApplied"||i=="InvalidCart"||i=="refresh"||i=="addresstype")&&(addrchange=1),(szip.length>=1&&sstate.length>=1&&scountry.length>=1||scountry!="US"&&scountry.length>=1)&&addrchange==1&&ajax_request_progress==0){if(get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null?get_Element("sameAsBilling").checked?u=1:(add_overlay("shipping_info",0),l=!0,u=0):u=1,get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null){var v=encodeURIComponent(jQuery("#shipping_firstname").pVal()),y=encodeURIComponent(jQuery("#shipping_lastname").pVal()),p=encodeURIComponent(jQuery("#shipping_company").pVal()),w=encodeURIComponent(jQuery("#shipping_phone").pVal());sAddress=encodeURIComponent(jQuery("#shipping_address").pVal()),o=encodeURIComponent(jQuery("#shipping_address2").pVal()),sCity=encodeURIComponent(jQuery("#shipping_city").pVal()),sState=encodeURIComponent(jQuery("#shipping_state").pVal()),sCountry=encodeURIComponent(jQuery("#shipping_country").pVal()),sZip=encodeURIComponent(jQuery("#shipping_zip").pVal())}else{var v=" ",y=" ",p=" ",w=" ";sAddress=" ",o=" ",sCity=" ",sState=" ",sCountry=" ",sZip=" "}var b=encodeURIComponent(jQuery("#billing_firstname").pVal()),k=encodeURIComponent(jQuery("#billing_lastname").pVal()),d=encodeURIComponent(jQuery("#billing_company").pVal()),g=encodeURIComponent(jQuery("#billing_phone").pVal());if(bAddress=encodeURIComponent(jQuery("#billing_address").pVal()),a=encodeURIComponent(jQuery("#billing_address2").pVal()),bCity=encodeURIComponent(jQuery("#billing_city").pVal()),bState=encodeURIComponent(jQuery("#billing_state").pVal()),bCountry=encodeURIComponent(jQuery("#billing_country").pVal()),bZip=encodeURIComponent(jQuery("#billing_zip").pVal()),s="",get_Element("shipping_addresstype")!="undefined"&&get_Element("shipping_addresstype")!="null"&&get_Element("shipping_addresstype")!=null&&(s=encodeURIComponent(jQuery("#shipping_addresstype").pVal())),h="US",h=jQuery("#"+n+"_country").val(),useAddressValidator=="1"&&h=="US"){if(getElementById_s("hdnAddrressValidatorResult").value="",f="addressvalidator.asp?no-cache="+Math.random(),t="doaction=verify&ct=single&at="+n+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():""),t+="&callBack=check_address2_pos('"+n+"');",t+="&name="+encodeURIComponent(jQuery("#"+n+"_firstname").pVal()+" "+jQuery("#"+n+"_lastname").pVal()),getElementById_s(n+"_company")&&(t+="&company="+encodeURIComponent(jQuery("#"+n+"_company").pVal())),t+="&address="+encodeURIComponent(jQuery("#"+n+"_address").pVal()),t+="&address2="+encodeURIComponent(jQuery("#"+n+"_address2").pVal()),t+="&city="+encodeURIComponent(jQuery("#"+n+"_city").pVal()),t+="&state="+encodeURIComponent(jQuery("#"+n+"_state").pVal()),t+="&zip="+encodeURIComponent(jQuery("#"+n+"_zip").pVal()),(t!=lastShippingAddress||validShippingAddress==0)&&getElementById_s(n+"_address").value!="")return lastShippingAddress=t,jQuery.ajax({url:f,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){jQuery("#divAddrressValidator .modal-content").html(n)},error:reportError}),l&&remove_overlay("shipping_info"),!1}else validShippingAddress=1;jQuery("#shipResult").html("Calculating shipping rates...."),add_overlay("billing_info",0),add_overlay("shipping_div",1),add_overlay("total_div",1),add_overlay("divPayment",1),ajax_request_progress=1,f="ship_ajax.asp?no-cache="+Math.random()+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():""),jQuery("#wid").val()==3&&(f+="&access_token="+jQuery("#access_token").val()+"&orderReference="+orderReferenceID),t="shipping_zip="+szip+"&shipping_city="+scity+"&shipping_state="+sstate+"&shipping_country="+scountry,t+="&sFirstname="+v,t+="&sLastname="+y,t+="&sCompany="+p,t+="&sPhone="+w,t+="&sAddress="+sAddress,t+="&sAddress2="+o,t+="&sCity="+sCity,t+="&sState="+sState,t+="&sCountry="+sCountry,t+="&sZip="+sZip,t+="&bFirstname="+b,t+="&bLastname="+k,t+="&bCompany="+d,t+="&bPhone="+g,t+="&bAddress="+bAddress,t+="&bAddress2="+a,t+="&bCity="+bCity,t+="&bState="+bState,t+="&bCountry="+bCountry,t+="&bZip="+bZip,t+="&sameAsBilling="+u,t+="&Addresstype="+s,c=getValuesAsArray(document.billing);for(r in c)(r=="echoFreightOptions"||r=="echoFreightOptions1"||r=="echoFreightOptions2"||r=="echoFreightOptions3"||r=="echoFreightOptions4"||r.toLowerCase().indexOf("collect")>0)&&(e=c[r],e=encodeURIComponent(e),t=t+"&"+r+"="+e);jQuery.ajax({url:f,dataType:"html",type:"POST",data:t,cache:!1,success:function(n){jQuery("#shipResult").html(n)},complete:function(){updateajax(i)},error:reportError})}}function updateajax(n){if(ajax_request_progress=0,remove_overlay("billing_info"),get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null&&(document.billing.sameAsBilling.checked||remove_overlay("shipping_info")),remove_overlay("shipping_div"),remove_overlay("total_div"),remove_overlay("divPayment"),n!="CouponApplied")if(get_Element("radio_ship")!=undefined){var t=jQuery("input[name=shipping]:checked","#billing").val();jQuery.isNumeric(t)||(t=-1),select_shipping(t)}else select_shipping(-1)}function reportError(n){isSubmitComplete=!1,ajax_request_progress=0,remove_overlay("billing_info"),get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null&&(document.billing.sameAsBilling.checked||remove_overlay("shipping_info")),n.status>0&&alert("Error processing request "+n.status+" - "+n),checkoutSwitch(!1)}function showHideShipping(){get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null&&(document.billing.sameAsBilling.checked?(jQuery("#notsameasbilling_box").slideUp(),jQuery("#sameasbilling_radio").prop("checked",!0)):(jQuery("#notsameasbilling_box").slideDown(),jQuery("#notsameasbilling_radio").prop("checked",!0)))}function selectGiftRegAddress(){remove_overlay("shipping_info"),get_Element("sameAsBilling")!="undefined"&&get_Element("sameAsBilling")!=null&&(get_Element("sameAsBilling").checked=!1),get_Element("shipping_firstname").value=jQuery("#giftreg_shipping_firstname").pVal(),get_Element("shipping_lastname").value=jQuery("#giftreg_shipping_lastname").pVal(),get_Element("shipping_company").value=jQuery("#giftreg_shipping_company").pVal(),get_Element("shipping_phone").value=jQuery("#giftreg_shipping_phone").pVal(),get_Element("shipping_address").value=jQuery("#giftreg_shipping_address").pVal(),get_Element("shipping_address2").value=jQuery("#giftreg_shipping_address2").pVal(),get_Element("shipping_city").value=jQuery("#giftreg_shipping_city").pVal(),get_Element("shipping_zip").value=jQuery("#giftreg_shipping_zip").pVal(),get_Element("shipping_country").value=jQuery("#giftreg_shipping_country").pVal(),populateState("shipping_state","shipping_country"),get_Element("shipping_state").value=jQuery("#giftreg_shipping_state").pVal(),check_address("")}function getElementById_s(n){var t=null;return document.getElementById?t=get_Element(n):document.all&&(t=document.all[n]),t}function remove_overlay(n){var t=document.getElementById("overlay_"+n);return t&&t.parentNode.removeChild(t),!1}function add_overlay(n,t){var r=document.getElementById("overlay_"+n),u,i;if(r)return!1;u=getElementById_s(n),i=document.createElement("div"),i.setAttribute("id","overlay_"+n),i.className="overlay",i.style.position="absolute",i.style.textAlign="center",i.style.display="block",t==1,DisableEnableForm(document.billing,!1)}function DisableEnableForm(n,t){for(objElems=n.elements,i=0;i<objElems.length;i++)objElems[i].disabled=t}function showGiftCertDetails(){get_Element("divGiftCertDetails").style.display=giftCertDetails,giftCertDetails=giftCertDetails==""?"none":""}function showDiscountDetails(){get_Element("divDiscountDetails").style.display=giftDiscountDetails,giftDiscountDetails=giftDiscountDetails==""?"none":""}function fillEmailDiv(){var n=get_Element("billing_email").value;n==""&&(n="Type your email above"),get_Element("divEmail")!="undefined"&&get_Element("divEmail")!=null&&(n="&nbsp;"+jQuery.trim(removeHTMLTags(n)),get_Element("divEmail").innerHTML=n)}function updateOrderEmail(){var t=get_Element("billing_email").value,i="ship_ajax.asp?action=updateOrderEmail&no-cache="+Math.random(),n="email="+encodeURIComponent(t)+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():"");jQuery("#wid").val()==3&&(n+="&access_token="+jQuery("#access_token").val()),jQuery.ajax({url:i,dataType:"html",type:"POST",data:n,cache:!1})}function updateOrderComments(n){var i="ship_ajax.asp?action=updateOrderComments&no-cache="+Math.random(),t="comment="+encodeURIComponent(n)+"&k="+(jQuery("#k").length>0?jQuery("#k").val():"")+"&wid="+(jQuery("#wid").length>0?jQuery("#wid").val():"");jQuery("#wid").val()==3&&(t+="&access_token="+jQuery("#access_token").val()+"&orderReference="+orderReferenceID),jQuery.ajax({url:i,dataType:"html",type:"POST",data:t,cache:!1})}function removeHTMLTags(n){var i=n,t;return i=i.replace(/&(lt|gt);/g,function(n,t){return t=="lt"?"<":">"}),t=i.replace(/<\/?[^>]+(>|$)/g,""),t=t.replace(/\u00a0/g,"")}function clearContent(n){n.value=removeHTMLTags(n.value)}function controlDivPayment(n){for(var i=document.getElementsByTagName("div"),t=0;t<i.length;t++)if(i[t].id.indexOf("divPaymentOption")>=0&&(obj1=get_Element(i[t].id),obj1!=undefined))if(n==""){obj1.style.display="";break}else obj1.style.display=obj1.id=="divPaymentOption"+n?"":"none"}function controlDivShipping(n){for(var i=document.getElementsByTagName("div"),t=0;t<i.length;t++)if(i[t].id.indexOf("divShipping")>=0&&i[t].id!="divShipping"&&i[t].id!="divShippingCUSTOM"&&(obj1=get_Element(i[t].id),obj1!=undefined))if(n==""){obj1.style.display="";break}else obj1.style.display=obj1.id=="divShipping"+n?"":"none"}function editAddress(n){n=="shippingdone"&&(jQuery("#shipping_info").slideUp(),jQuery("#divShippingInfo").slideDown(),jQuery("#btnEditShipping").show(),jQuery("#btnEditShippingDone").hide(),jQuery("#spnShippingFirstName").html(jQuery("#shipping_firstname").val()),jQuery("#spnShippingLastName").html(jQuery("#shipping_lastname").val()),jQuery("#spnShippingCompany").html(jQuery("#shipping_company").val()),jQuery("#spnShippingPhone").html(jQuery("#shipping_phone").val()),jQuery("#spnShippingAddress").html(jQuery("#shipping_address").val()),jQuery("#spnShippingAddress2").html(jQuery("#shipping_address2").val()),jQuery("#spnShippingCity").html(jQuery("#shipping_city").val()),jQuery("#spnShippingState").html(jQuery("#shipping_state").val()),jQuery("#spnShippingCountry").html(jQuery("#shipping_country").val()),jQuery("#spnShippingZip").html(jQuery("#shipping_zip").val()),changedaddress&&(check_address("shipping"),changedaddress=!1)),n=="shipping"&&(jQuery("#divShippingInfo").slideUp(),jQuery("#shipping_info").slideDown(),jQuery("#btnEditShipping").hide(),jQuery("#btnEditShippingDone").show()),n=="billingdone"&&(jQuery("#billing_info2").slideUp(),jQuery("#divBillingInfo").slideDown(),jQuery("#btnEditBilling").show(),jQuery("#btnEditBillingDone").hide(),jQuery("#spnBillingFirstName").html(jQuery("#billing_firstname").val()),jQuery("#spnBillingLastName").html(jQuery("#billing_lastname").val()),jQuery("#spnBillingCompany").html(jQuery("#billing_company").val()),jQuery("#spnBillingPhone").html(jQuery("#billing_phone").val()),jQuery("#spnBillingAddress").html(jQuery("#billing_address").val()),jQuery("#spnBillingAddress2").html(jQuery("#billing_address2").val()),jQuery("#spnBillingCity").html(jQuery("#billing_city").val()),jQuery("#spnBillingState").html(jQuery("#billing_state").val()),jQuery("#spnBillingCountry").html(jQuery("#billing_country").val()),jQuery("#spnBillingZip").html(jQuery("#billing_zip").val()),jQuery("#spnBillingEmail").html(jQuery("#billing_email").val()),changedaddress&&(check_address("billing"),changedaddress=!1)),n=="billing"&&(jQuery("#divBillingInfo").slideUp(),jQuery("#billing_info2").slideDown(),jQuery("#btnEditBilling").hide(),jQuery("#btnEditBillingDone").show())}var scity="",szip="",scountry="",sstate="",saddress="",bcity="",bzip="",bcountry="",bstate="",baddress="",addrchange="",ajax_request_progress=0,selectedShipId=0,useAddressValidator,validShippingAddress=0,lastShippingAddress="",strOriginalDivPaymentContent="",bolPageLoaded=!1,ccNumerNotAllowedMessage,changedaddress=!1,giftCertDetails,giftDiscountDetails;extendPvalJquery(),addLoadEvent(extendPvalJquery),giftCertDetails="",giftDiscountDetails=""