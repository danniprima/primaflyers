function addReply(n){var t,i;t=530,i=795,document.body.clientWidth<767&&(t=330,i=300);try{recaptchaContent==""&&(recaptchaContent=jQuery("#divReCaptcha").clone(!0,!0)),jQuery("#divReCaptcha").html(""),jQuery("#divReCaptchaReply").html(recaptchaContent),Recaptcha.reload()}catch(r){}jQuery("#commentid").val(n),jQuery("#divAddReply").modal({minHeight:t,minWidth:i,onShow:function(){jQuery("#imgBlogReplyCaptcha").attr("src","/admin/image_pw.asp?sessionname=blogreply")},onClose:function(){try{closeModal()}catch(t){jQuery.modal.close()}}}),jQuery("#imgBlogReplyCaptcha").length<=1&&jQuery("#imgBlogReplyCaptcha").attr("src","/admin/image_pw.asp?sessionname=blogreply")}function validateReply(){var n="";return jQuery("#blog_comment_reply_name").val()==""&&(n+="\nMissing Reply Name."),jQuery("#blog_comment_reply_email").val()==""&&(n+="\nMissing Reply Email."),validateEmail(jQuery("#blog_comment_reply_email").val())||(n+="\nInvalid Email Format."),jQuery("#blog_comment_reply_comment").val()==""&&(n+="\nMissing Reply Text."),n!=""?(alert("Please fix the following errors before submitting reply\n"+n),!1):!0}function validateEmail(n){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(n)}function submitReply(){var t;bolSubmitting=1,t=ajaxPostJson("savereply","frmCommentReply",validateReply)}function closeModal(){jQuery("button.close").trigger("click"),window.location.reload();try{jQuery("#divReCaptchaReply").html(""),jQuery("#divReCaptchaReply").html(recaptchaContent),Recaptcha.reload()}catch(n){}jQuery.modal.close()}function ajaxPostJson(n,t,i){var r,u,f=!0,e=new Date,o=e.getMilliseconds(),s=!1,h="";return jQuery("#"+t+" #cAction").val(n),u=jQuery("#"+t).serialize()+"&ajaxsubmit=1",r=!0,f=!1,jQuery.ajax({url:"blog.asp",dataType:"json",type:"post",data:u,cache:!1,async:f,beforeSend:i,statusCode:{301:function(){alert("301 - Reload the page.")},302:function(){alert("302 - Reload the page.")},304:function(){alert("304 - No new data returned.")},400:function(){alert("400 - Invalid Data Request.")},401:function(){alert("401 - Unauthorized request.")},403:function(){alert("403 - Request forbidden.")},404:function(){alert("404 - File Not Found.")},406:function(){alert("406 - Invalid Data format submitted.")},429:function(){alert("429 - Too many requests being processed at this time.")},500:function(){alert("500 - A problem was detected.")},502:function(){alert("502 - Server is down.")},503:function(){alert("503 - Server unavailable.")},504:function(){alert("504 - Gateway timeout.")}},success:function(t){try{switch(n){case"savereply":t.errorMsg!=""?(t.errorUrl!=""?window.location=t.errorUrl:alert(t.errorMsg),t.errorMsg!="Incorrect Verification Word"&&closeModal()):t.commentReplies!=""?(alert("Your reply has been auto-approved and will display immediately."),closeModal(),jQuery("#blogreply"+jQuery("#commentid").val()).html(t.commentReplies)):(alert("Your reply to the comment will appear after it is approved by the Admin."),closeModal())}}catch(i){}},error:function(n){document.body.style.cursor="",n.statusCode>0&&(alert("Error processing request "+n.statusCode+" - "+n),alert(n.responseText),document.write(n.responseText),r=!1)}}),!1}jQuery(document).ready(function(){jQuery(".addthis_toolbox").length<=0?jQuery(".social-bookmarking").remove():jQuery("#blog").addClass("post-page"),jQuery(".blogarchive").each(function(){jQuery(".post-image",this).html()!=undefined&&jQuery(this).addClass("normal")})});var recaptchaContent="";jQuery("#submitReply").click(function(n){n.preventDefault();var t=jQuery(this).data("submit");submitReply(t)}),jQuery("#divReCaptcha").length<=0?jQuery("#divReCaptchaReply").remove():jQuery("button.close").click(function(){jQuery("#divReCaptchaReply").html(""),jQuery("#divReCaptcha").html(recaptchaContent),Recaptcha.reload()})